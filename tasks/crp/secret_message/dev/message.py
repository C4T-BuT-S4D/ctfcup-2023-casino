import os
from Crypto.Util.number import getPrime, bytes_to_long


def main():
    p, q, r = getPrime(1024), getPrime(1024), getPrime(1010)
    n = p * q
    secret = (p + q) % r

    e = 31337
    pt = bytes_to_long((os.getenv("FLAG").encode()))
    ct = pow(pt, e, n)

    print(f"n = {n}")
    print(f"e = {e}")
    print(f"ct = {ct}")
    print(f"r = {r}")
    print(f"secret = {secret}")

    # n = 18764959295797775039903674927695490008753313149376076535810144354469279780343181595214170966472706954179919987189887057941328914179626075519844576575437112550426513292515911990732322374940603018521534872318673534429897266629909881001661849719339376034982269407148575585217754868645190875821483378989455899418285615143142400691935694639320376666030487228828996193772667157411925523163948590368233132986412048417131590222417653599924453146297769238959983916563830671540123883372466929371399933687344263056349929470109302944948759924110406916544713053228220591177515777503549780554719799155990952429549638575105399097731
    # e = 31337
    # ct = 14707862634180777713762036665067273186780575366937620456245073937946747194852461655101394708690329371480679314134284434226546986754528961843271148580429275805147820993782368931213037501824282776420803013947438523682811580559909689059143697660787586667406025443909627012421183373389695528155266279341013502262030237496233125819321116374759711158112199774281064871173479140970922612288818093646182540662199720243025943433713044218266826539761321029886735744901302596668312100192455265458811338571103811488716046909498443051435810648988227721733072605383432195733004446581890247946006728691137070527705180218568784323687
    # r = 10110959017493545974469218287433685134020226822646011475199312167105812484343259554965779675827357712665095023032721400501063400725947420136089026041453719551427450744128164678376259287203121205506782614957622961011854536323138421763634627131120637883163949452604838947574844102677861849207841306059903
    # secret = 956407946933498384422937088470264819167916831599088916589711808995857183259731036239577883075434389560657764469459204418781962974920404669109987645325385871902446515015252807256737111688742988146291716240995499525496085492243669227882943968986522083859932844572728632485207321885184812245427897571696


if __name__ == "__main__":
    main()
